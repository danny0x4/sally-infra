# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: token-updater-kiali
#   namespace: istio-system
# data:
#   update-token.sh: |
#     #!/bin/bash

#     # Generate new Kiali token
#     NEW_TOKEN=$(kubectl -n istio-system create token kiali)

#     # Update token in Vault
#     VAULT_ADDR="http://vault.vault.svc.cluster.local:8200"  # Ganti dengan alamat Vault Anda
#     VAULT_TOKEN="hvs.M59eEhlEnpGfiui0oil7nUUt"   # Ganti dengan token Vault Anda

#     curl -H "X-Vault-Token: $VAULT_TOKEN" \
#          -X PUT \
#          -d "{\"data\": {\"token\": \"$NEW_TOKEN\"}}" \
#          $VAULT_ADDR/v1/kv-v2/data/kiali/token

#     echo "Kiali token updated successfully at $(date)"